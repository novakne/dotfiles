#!/usr/bin/env bash
#
# Open an exit menu with confirmation in dmenu-wl
#
# USAGE: dmenu-power
# REQUIREMENTS: dmenu


declare -a dmenu_opts

dmenu_opts=(
  -i -h 28
  -fn Overpass
  -nb '#23222b'
  -nf '#eae9ee'
  -sb '#e8ec77'
  -sf '#23222b'
)

_confirm() {
    printf -- '%s\n%s\n' "Yes" "No" \
      | dmenu-wl "${dmenu_opts[@]}" -p "${1:-_confirm:}"
}

quit=" Quit River"
shutdown=" Shutdown"
reboot=" Reboot"
suspend=" Suspend"
hibernate=" Hibernate"

options="${quit}\n${shutdown}\n${reboot}\n${suspend}\n${hibernate}"
selection=$(echo -e "${options}" | dmenu-wl "${dmenu_opts[@]}" -p 'Exit: ')

case ${selection} in
  "$quit") riverctl exit ;;
  "$shutdown") [[ $(_confirm "$@") = 1 ]] && (systemctl poweroff) ;;
  "$reboot") [[ $(_confirm "$@") = 1 ]] && (systemctl reboot) ;;
  "$suspend") [[ $(_confirm "$@") = 1 ]] && (systemctl suspend) ;;
  "$hibernate") [[ $(_confirm "$@") = 1 ]] && (systemctl hibernate) ;;
esac

unset dmenu_opts

