#!/usr/bin/env bash
#
# Update foot terminal master branch


#!/usr/bin/env bash
#
# Update foot terminal master branch


cd "$HOME"/.local/share/bld/foot || exit

[[ -d bld/release ]] && trash-put bld/release

git pull

mkdir -p bld/release && cd bld/release || exit
export CFLAGS="$CFLAGS -O3 -Wno-missing-profile"
meson --buildtype=release --prefix=/usr -Db_lto=true ../..
meson configure -Db_pgo=generate
ninja

foot_tmp_file=$(mktemp)
./foot --config=/dev/null --term=alacritty sh -c "$HOME/.local/share/bld/foot/scripts/generate-alt-random-writes.py --scroll --scroll-region --colors-regular --colors-bright --colors-256 --colors-rgb --attr-bold --attr-italic --attr-underline ${foot_tmp_file} && cat ${foot_tmp_file}"
rm "${foot_tmp_file}"
meson configure -Db_pgo=use
ninja

sudo ninja install

