#!/usr/bin/env bash
#
# Switch/fetch/rebase the main/master upstream branch
# Without any branch passed as arguments, the default is master
#
# USAGE: git sfr [branch]
#
# REQUIREMENTS: git
# OPTIONALS:

# Error message in STDERR
_err()
{
	printf -- '%s\n' "[$(date +'%Y-%m-%d %H:%M:%S')]: $*" >&2
	exit 1
}

git-sfr()
{
	local branch

	[[ "$#" -gt 1 ]] && _err "Too many arguments"
	branch="${1:-master}"

	git switch "${branch}"
	git fetch -p upstream
	git rebase upstream/"${branch}"

	unset -f _err
}

git-sfr "$@"
