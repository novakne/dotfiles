#!/usr/bin/env bash
#
# Switch/fetch/merge the main/master upstream branch
#
# USAGE: git sfr <branch>
#
# REQUIREMENTS: git

# Error message in STDERR
_err()
{
	printf -- '%s\n' "[$(date +'%Y-%m-%d %H:%M:%S')]: $*" >&2
	exit 1
}

git-sfr()
{
    local branch="$1"

	[[ "$#" -gt 1 ]] && _err "Too many arguments"
	[[ "$#" -eq 0 ]] && branch="master"

	git switch "${branch}"
	git fetch -p upstream
	git rebase upstream/"${branch}"

	unset -f _err
}

git-sfr "$@"
