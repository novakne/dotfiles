#!/usr/bin/env bash
#
# Convert markdown file to pdf with pandoc
#
# USAGE: mdpdf <input_file> <output_file>
# REQUIREMENTS: pandoc

# Error message in STDERR
_err()
{
	printf -- '%s\n' "[$(date +'%Y-%m-%d %H:%M:%S')]: $*" >&2
}

mdpdf()
{
	local pdf_dir pdf_theme
	local -a pandoc_opts

	pdf_dir="$HOME"/docs/notes/pdf
	pdf_theme="zenburn"

	pandoc_opts=(
		-V geometry:margin=0.5in
		--listings
		--highlight-style="${pdf_theme}"
		--toc
		--toc-depth=4
	)

	if [ $# == "0" ]; then
		_err "Usage: mdpdf imput_file output_file"
		exit 1
	elif [ "$2" = "0" ]; then
		pandoc -s -f gfm "$1".md -o "${pdf_dir}"/"$1".pdf "${pandoc_opts[@]}"
	else
		pandoc -s -f gfm "$1".md -o "${pdf_dir}"/"$2".pdf "${pandoc_opts[@]}"
	fi

	unset -f _err
}

mdpdf "$@"
